{"version":3,"sources":["Level.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/Script/Game","sourcesContent":["import Cookie, { CookieSwapDirection, CookieTile_Width, CookieTile_Height } from \"./Cookie\";\nimport ExtraCookieTypeManager, { CookieType, CookieMax_X, CookieMax_Y, CookieTypeObject, CookieExtraType } from \"../Data/ExtraCookieTypeManager\";\n\nconst {ccclass, property} = cc._decorator;\n\n\nexport const CookieAnimationTimeInterval: number = 0.15;\n\n\n@ccclass\nexport default class Level extends cc.Component {\n\n    @property(cc.Node)\n    m_tileNode: cc.Node = null;\n    @property(cc.Node)\n    m_cookieNode: cc.Node = null;\n    @property(cc.Node)\n    m_tileNodeInstance: cc.Node = null;\n\n\n    private m_cookieInstance = null;\n    //  audio clips\n    private m_swapAudioClip: cc.AudioClip = null;\n    private m_invalidSwapAudioClip: cc.AudioClip = null;\n    private m_matchAudioClip: cc.AudioClip = null;\n    private m_fallingAudioClip: cc.AudioClip = null;\n    private m_addCookiesAudioClip: cc.AudioClip = null;\n    \n\n    // private m_swapCookieArray: Array<cc.Node> = [];\n\n    private m_tilesJSONArray: Array<Array<number>> = new Array<Array<number>>();\n    private m_tilesNodesArray: Array<Array<cc.Node>> = new Array<Array<cc.Node>>();\n    private m_cookieNodesArray: Array<Array<cc.Node>> = new Array<Array<cc.Node>>();\n\n    // private cookies = Array2D<Cookie>(columns: numColumns, rows: numRows)\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        // this.loadCookieInstance();\n        // this.loadTileJsonData();\n        this.loadAudioRes();\n\n    }\n\n    start () {\n        this.m_tileNodeInstance.active = false;\n        // this.initTileNodeUI();\n        \n    }\n\n    update (dt) \n    {\n\n    }\n\n    public shuffle() {\n        cc.log(\"shuffle func is called\");\n        \n        //  test func\n        // this.detectPossibleSwaps();\n        // this.detectHorizontalMatches();\n        // this.detectVerticalMatches();\n        // this.fillHoles();\n        // while (this.checkFillHoles()) \n        // {\n\n        // }\n        // this.topUpCookies();\n\n    }\n\n    private initDataAndUI() {\n        this.initTileNodeArray();\n        this.initClearCookieNodeArray();\n        this.initTileNodeUI();\n        //\n        this.loadCookieInstance();\n    }\n\n    private resetTileJSONArray() {\n        for (let index_X = 0; index_X < CookieMax_X; index_X++) {\n            let tmpJsonArray: Array<number> = [];\n            for (let index_Y = 0; index_Y < CookieMax_Y; index_Y++) {\n                tmpJsonArray.push(0);\n            }\n            this.m_tilesJSONArray.push(tmpJsonArray);\n        }\n    }\n    private initTileNodeArray() {\n        for (let index_Y = 0; index_Y < CookieMax_Y; index_Y++) {\n            let tmpArray: Array<cc.Node> = [];\n            for (let index_X = 0; index_X < CookieMax_X; index_X++) {\n                tmpArray.push(null);\n            }\n            this.m_tilesNodesArray.push(tmpArray);\n        }\n    }\n    private initClearCookieNodeArray() {\n        for (let index_Y = 0; index_Y < CookieMax_Y; index_Y++) {\n            let tmpArray: Array<cc.Node> = [];\n            for (let index_X = 0; index_X < CookieMax_X; index_X++) {\n                tmpArray.push(null);\n            }\n            this.m_cookieNodesArray.push(tmpArray);\n        }\n    }\n\n    private initTileNodeUI() {\n        for (let idx_Y = 0; idx_Y < CookieMax_Y; idx_Y++) {\n            for (let idx_X = 0; idx_X < CookieMax_X; idx_X++) {\n                if (this.m_tilesJSONArray[idx_X][idx_Y] > 0) {\n                    let tileItem = cc.instantiate(this.m_tileNodeInstance);\n                    // tileItem.x = tileItem.width / 2 + tileItem.width * idx_X;\n                    // tileItem.y = tileItem.height / 2 + tileItem.height * idx_Y;\n                    tileItem.setPosition(this.getCookiePosition(idx_X, idx_Y));\n                    tileItem.active = true;\n                    this.m_tileNode.addChild(tileItem);\n                    this.m_tilesNodesArray[idx_X][idx_Y] = tileItem;    \n                }\n            }   \n        }\n    }\n\n    // public cookie(column: number, row: number): Cookie {\n    //     // precondition(column >= 0 && column < this.numColumns)\n    //     // precondition(row >= 0 && row < this.numRows)\n    //     // return cookies[column, row]\n    //     return null;\n    // }\n\n    // private shuffle(): Array<Cookie> {\n    //     // return this.createInitialCookies()\n    //     return [];\n    // }\n      \n    // private createInitialCookies(): Array<Cookie> {\n    //     let set: Array<Cookie> = []\n        \n    //     // 1\n    //     // for row in 0..<numRows {\n    //     //   for column in 0..<numColumns {\n        \n    //     //     // 2\n    //     //     let cookieType = CookieType.random()\n        \n    //     //     // 3\n    //     //     let cookie = Cookie(column: column, row: row, cookieType: cookieType)\n    //     //     cookies[column, row] = cookie\n        \n    //     //     // 4\n    //     //     set.insert(cookie)\n    //     //   }\n    //     // }\n    //     return set;\n    // }\n\n    public loadTileJsonData(jsonRes: string) {\n        if (jsonRes == \"\") { return; }\n        cc.loader.loadRes(jsonRes, function (err, jsonAsset) {\n            if(err != null) {\n                return;\n            }\n            this.resetTileJSONArray();\n            let data = jsonAsset.json;\n            let tileArray = data.tiles;\n            for (let index_Y = 0; index_Y < tileArray.length; index_Y++) {\n                const element = tileArray[index_Y];\n                for (let idx = 0; idx < element.length; idx++) {\n                    const e = element[idx];\n                    this.m_tilesJSONArray[idx][tileArray.length - index_Y - 1] = e;\n                }\n            }\n\n            this.initDataAndUI();\n        }.bind(this));\n    }\n    private loadCookieInstance() {\n        cc.loader.loadRes(\"prefab/Cookie\", function(error, prefab) {\n            if(error != null) {\n                return;\n            }\n            this.m_hasLoadedCookie = true;\n            let node = cc.instantiate(prefab);\n            this.m_cookieInstance = node;\n            //\n            this.createInitialCookies();\n        }.bind(this));\n    }\n\n    private controlAllCookieTouchable(touchable: boolean)\n    {\n        for (let index_X = 0; index_X < CookieMax_X; index_X++)\n        {\n            for (let index_Y = 0; index_Y < CookieMax_Y; index_Y++)\n            {\n                let cookieNode = this.m_cookieNodesArray[index_X][index_Y];\n                if (cookieNode)\n                {\n                    let script: Cookie = cookieNode.getComponent(\"Cookie\");\n                    script.setCookieTouchable(touchable);\n                }\n            }\n        }\n    }\n\n    private createInitialCookies() {\n        if (this.m_cookieInstance == null) \n        {\n            this.loadCookieInstance();\n        }\n        else \n        {\n            for (let idx_Y = 0; idx_Y < CookieMax_Y; idx_Y++) \n            {\n                for (let idx_X = 0; idx_X < CookieMax_X; idx_X++) \n                {\n                    if (this.m_tilesNodesArray[idx_X][idx_Y] == null) \n                    {\n                        continue;\n                    }\n                    let cookieType = Math.floor(Math.random() * CookieType.CookieTypeCount);\n\n                    let node = this.createCookieAtLevel(idx_X, idx_Y, cookieType);\n                    let script: Cookie = node.getComponent(\"Cookie\");\n\n                    \n\n                    if (idx_X >= 2) \n                    {\n                        let node_X_1 = this.m_cookieNodesArray[idx_X - 1][idx_Y];\n                        let node_X_2 = this.m_cookieNodesArray[idx_X - 2][idx_Y];\n                        while (node_X_1 && node_X_1.getComponent(\"Cookie\").getCookieType() == cookieType && node_X_2 && node_X_2.getComponent(\"Cookie\").getCookieType() == cookieType) {\n                            cookieType = Math.floor(Math.random() * CookieType.CookieTypeCount);\n                            script.setCookieType(cookieType);\n                        }\n                    }\n                    if (idx_Y >= 2) \n                    {\n                        let node_Y_1 = this.m_cookieNodesArray[idx_X][idx_Y - 1];\n                        let node_Y_2 = this.m_cookieNodesArray[idx_X][idx_Y - 2];\n                        while (node_Y_1 && node_Y_1.getComponent(\"Cookie\").getCookieType() == cookieType && node_Y_2 && node_Y_2.getComponent(\"Cookie\").getCookieType() == cookieType) {\n                            cookieType = Math.floor(Math.random() * CookieType.CookieTypeCount);\n                            script.setCookieType(cookieType);\n                        }\n                    }\n\n                }\n            }\n            //\n            this.firstDetectAllChains();\n        }\n    }\n\n    // private checkCookies() {\n    //     this.getCheckedCookies();\n    // }\n    private startSwapCookies(cookieNode: cc.Node, swapDirection: CookieSwapDirection) {\n        if (cookieNode == null) \n        {\n            this.node.runAction(cc.sequence(cc.delayTime(CookieAnimationTimeInterval), cc.callFunc(function () {\n                this.controlAllCookieTouchable(true);\n            }.bind(this))));\n            return; \n        }\n        \n        let script: Cookie = cookieNode.getComponent(\"Cookie\");\n        let cookiePos = script.getCookie_X_Y();\n        let newCookiePos = script.getCookie_X_Y();\n        if (swapDirection == CookieSwapDirection.LEFT) {\n            newCookiePos.x -= 1;\n        }\n        else if (swapDirection == CookieSwapDirection.RIGHT) {\n            newCookiePos.x += 1;\n        }\n        else if (swapDirection == CookieSwapDirection.UP) {\n            newCookiePos.y += 1;\n        }\n        else if (swapDirection == CookieSwapDirection.DOWN) {\n            newCookiePos.y -= 1;\n        }\n        if (cookiePos.x != newCookiePos.x || cookiePos.y != newCookiePos.y) {\n            let swapCookieNode: cc.Node = null;\n            for (const key in this.m_cookieNode.children) {\n                if (this.m_cookieNode.children.hasOwnProperty(key)) {\n                    const element = this.m_cookieNode.children[key];\n                    // if (element == null) { continue; }\n                    let script: Cookie = element.getComponent(\"Cookie\");\n                    let tmpCookiePos = script.getCookie_X_Y();\n                    if (tmpCookiePos.x == newCookiePos.x && tmpCookiePos.y == newCookiePos.y) {\n                        swapCookieNode = element;\n                        script.setOperationState(true);\n                        break;\n                    }\n                }\n            }\n            if (swapCookieNode != null) {\n                script.setOperationState(true);\n                this.performSwapCookies(cookieNode, swapCookieNode);\n            }\n        }\n    }\n\n    private performSwapCookies(firstCookieNode: cc.Node, lastCookieNode: cc.Node)\n    {\n        this.swapCookies(firstCookieNode, lastCookieNode);\n        this.node.runAction(cc.sequence(cc.delayTime(CookieAnimationTimeInterval * 2), cc.callFunc(function () {\n            this.detectAllChains(firstCookieNode, lastCookieNode);\n        }.bind(this))));\n        \n    }\n    private swapCookies(firstCookieNode: cc.Node, lastCookieNode: cc.Node)\n    {\n        if (firstCookieNode == null || lastCookieNode == null) { return; }\n        let swapTimeInterval = CookieAnimationTimeInterval;\n        let firstScript: Cookie = firstCookieNode.getComponent(\"Cookie\");\n        let lastScript: Cookie = lastCookieNode.getComponent(\"Cookie\");\n        let tmpFirst_X_Y = firstScript.getCookie_X_Y();\n        let tmpLast_X_Y = lastScript.getCookie_X_Y();\n        let absXLength = Math.abs(tmpFirst_X_Y.x - tmpLast_X_Y.x);\n        let absYLength = Math.abs(tmpFirst_X_Y.y - tmpLast_X_Y.y);\n        if (absXLength + absYLength == 1) {\n            this.swapCookiesInArray(tmpFirst_X_Y, tmpLast_X_Y);\n            let firstCookiePos = firstCookieNode.position;\n            let lastCookiePos = lastCookieNode.position;\n            //一个为all的cookie或者两个都是extra的cookie\n            let isExtraSwap: boolean = false;\n            if (firstScript.getExtraType() == CookieExtraType.Extra_All || lastScript.getExtraType() == CookieExtraType.Extra_All)\n            {\n                isExtraSwap = true;\n            }\n            else if (firstScript.getExtraType() != CookieExtraType.Extra_Normal && lastScript.getExtraType() != CookieExtraType.Extra_Normal)\n            {\n                isExtraSwap = true;\n            }\n            if (!this.hasChain(firstCookieNode) && !this.hasChain(lastCookieNode) && !isExtraSwap)\n            {\n                this.playInvalidSwapAudio();\n                this.swapCookiesInArray(tmpFirst_X_Y, tmpLast_X_Y);\n                this.restoreCookieOperateState();\n                lastCookieNode.runAction(cc.sequence(cc.moveTo(swapTimeInterval, firstCookiePos), cc.delayTime(swapTimeInterval), cc.moveTo(swapTimeInterval, lastCookiePos)));\n                firstCookieNode.runAction(cc.sequence(cc.moveTo(swapTimeInterval, lastCookiePos), cc.delayTime(swapTimeInterval), cc.moveTo(swapTimeInterval, firstCookiePos)));\n            }\n            else\n            {\n                this.playSwapAudio();\n                lastCookieNode.runAction(cc.moveTo(swapTimeInterval, firstCookiePos));\n                firstCookieNode.runAction(cc.moveTo(swapTimeInterval, lastCookiePos));\n            }\n        }\n    }\n\n    //刚刚加载完检测\n    private firstDetectAllChains()\n    {\n        this.controlAllCookieTouchable(true);\n        this.node.runAction(cc.sequence(cc.delayTime(CookieAnimationTimeInterval * 8), cc.callFunc(function () \n        {\n            this.detectAllChains();\n        }.bind(this))));\n    }\n    //  检查是否存在可消除chain\n    private detectAllChains(firstCookieNode?: cc.Node, lastCookieNode?: cc.Node)\n    {\n        let isExtraSwap: boolean = false;\n        let chainsArray = [];\n        if (firstCookieNode != null && lastCookieNode != null)\n        {\n            let firstScript: Cookie = firstCookieNode.getComponent(\"Cookie\");\n            let lastScript: Cookie = lastCookieNode.getComponent(\"Cookie\");\n            if (firstScript.getExtraType() == CookieExtraType.Extra_All || lastScript.getExtraType() == CookieExtraType.Extra_All)\n            {\n                isExtraSwap = true;\n            }\n            else if (firstScript.getExtraType() != CookieExtraType.Extra_Normal && lastScript.getExtraType() != CookieExtraType.Extra_Normal)\n            {\n                isExtraSwap = true;\n            }\n\n        }\n        if (isExtraSwap)\n        {\n            chainsArray = this.detectExtraMatches(firstCookieNode, lastCookieNode);\n        }\n        else\n        {\n            chainsArray = this.detectMatches();\n        }\n        if (chainsArray.length > 0)\n        {\n            let delayTime = this.removeMatches(chainsArray);\n            this.node.runAction(cc.sequence(cc.delayTime(delayTime), cc.callFunc(function () {\n                this.checkFillHolesAnimation();\n            }.bind(this))));\n        }\n        else \n        {\n            this.controlAllCookieTouchable(true);\n        }\n    }\n    // private hasEmptyHoles(): boolean {\n    //     let hasEmptyHoles: boolean = false;\n    //     for (let index_X = 0; index_X < CookieMax_X; index_X++)\n    //     {\n    //         for (let index_Y = 0; index_Y < CookieMax_Y; index_Y++)\n    //         {\n    //             let cookieNode = this.m_cookieNodesArray[index_X][index_Y];\n    //             if (cookieNode == null && this.m_tilesNodesArray[index_X][index_Y] != null)\n    //             {\n    //                 hasEmptyHoles = true;\n    //                 break;\n    //             }\n    //         }\n    //         if (hasEmptyHoles)\n    //         {\n    //             break;\n    //         }\n    //     }\n    //     return hasEmptyHoles;\n    // }\n    private swapCookiesInArray(firstCookie_X_Y: cc.Vec2, lastCookie_X_Y: cc.Vec2)\n    {\n        let firstCookieNode = this.m_cookieNodesArray[firstCookie_X_Y.x][firstCookie_X_Y.y];\n        let lastCookieNode = this.m_cookieNodesArray[lastCookie_X_Y.x][lastCookie_X_Y.y];\n        if (firstCookieNode == null || lastCookieNode == null) { return; }\n        //\n        let firstScript: Cookie = firstCookieNode.getComponent(\"Cookie\");\n        let lastScript: Cookie = lastCookieNode.getComponent(\"Cookie\");\n        let tmpFirst_X_Y = firstScript.getCookie_X_Y();\n        let tmpLast_X_Y = lastScript.getCookie_X_Y();\n        firstScript.setCookie_X_Y(tmpLast_X_Y.x, tmpLast_X_Y.y);\n        lastScript.setCookie_X_Y(tmpFirst_X_Y.x, tmpFirst_X_Y.y);\n        let tmpFirstNode = this.m_cookieNodesArray[firstCookie_X_Y.x][firstCookie_X_Y.y];\n        this.m_cookieNodesArray[firstCookie_X_Y.x][firstCookie_X_Y.y] = lastCookieNode;\n        this.m_cookieNodesArray[lastCookie_X_Y.x][lastCookie_X_Y.y] = tmpFirstNode;\n    }\n\n    //所有cookie是否被交换过状态重置为false\n    private restoreCookieOperateState()\n    {\n        for (let index_X = 0; index_X < CookieMax_X; index_X++) {\n            for (let index_Y = 0; index_Y < CookieMax_Y; index_Y++) {\n                let cookieNode = this.m_cookieNodesArray[index_X][index_Y];\n                if (cookieNode == null) { continue; }\n                let script: Cookie = cookieNode.getComponent(\"Cookie\");\n                script.setOperationState(false);\n            }\n        }\n    }\n    \n    // private unCheckAllCookies() {\n    //     for (const key in this.m_cookieNode.children) {\n    //         if (this.m_cookieNode.children.hasOwnProperty(key)) {\n    //             const element = this.m_cookieNode.children[key];\n    //             let script = element.getComponent(\"Cookie\");\n    //             script.unCheckedCookie();\n    //         }\n    //     }\n    // }\n\n    private detectPossibleSwaps() {\n        // var set: Set<Swap> = []\n\n        for (let index_X = 0; index_X < CookieMax_X - 1; index_X++) {\n            for (let index_Y = 0; index_Y < CookieMax_Y - 1; index_Y++) {\n                //detect right\n                let firstCookieNode = this.m_cookieNodesArray[index_X][index_Y];\n                let lastCookieNode = this.m_cookieNodesArray[index_X + 1][index_Y];\n                if (firstCookieNode == null || lastCookieNode == null) { continue; }\n                let firstScript: Cookie = firstCookieNode.getComponent(\"Cookie\");\n                let lastScript: Cookie = lastCookieNode.getComponent(\"Cookie\");\n                let tmpFirst_X_Y = firstScript.getCookie_X_Y();\n                let tmpLast_X_Y = lastScript.getCookie_X_Y();\n                if (firstScript.getCookieType() == lastScript.getCookieType()) { continue; }\n                this.swapCookiesInArray(tmpFirst_X_Y, tmpLast_X_Y);\n                if (this.hasChain(firstCookieNode) || this.hasChain(lastCookieNode))\n                {\n                    cc.log(\"valiable swap at right cookie:[\"+index_X,\",\"+index_Y+\"]\" + \" AND \" + \"cookie:[\"+String(index_X + 1)+\",\"+index_Y+\"]\");\n                }\n                this.swapCookiesInArray(tmpFirst_X_Y, tmpLast_X_Y);\n                //detect top\n                lastCookieNode = this.m_cookieNodesArray[index_X][index_Y + 1];\n                if (lastCookieNode == null) { continue; }\n                lastScript = lastCookieNode.getComponent(\"Cookie\");\n                tmpLast_X_Y = lastScript.getCookie_X_Y();\n                if (firstScript.getCookieType() == lastScript.getCookieType()) { continue; }\n                this.swapCookiesInArray(tmpFirst_X_Y, tmpLast_X_Y);\n                if (this.hasChain(firstCookieNode) || this.hasChain(lastCookieNode))\n                {\n                    cc.log(\"valiable swap at top cookie:[\"+index_X,\",\"+index_Y+\"]\" + \" AND \" + \"cookie:[\"+index_X+\",\"+String(index_Y + 1)+\"]\");\n                }\n                this.swapCookiesInArray(tmpFirst_X_Y, tmpLast_X_Y);\n            }\n        }\n      \n        // possibleSwaps = set\n    }\n    private hasChain(cookie: cc.Node): Boolean {\n        let cookieScript: Cookie = cookie.getComponent(\"Cookie\");\n        let cookieType = cookieScript.getCookieType();\n        let cookie_X = cookieScript.getCookie_X_Y().x;\n        let cookie_Y = cookieScript.getCookie_X_Y().y;\n\n        // Horizontal chain check\n        let horizontalLength = 1;\n      \n        // Left\n        let i = cookie_X - 1;\n        while (i >= 0 && this.m_cookieNodesArray[i][cookie_Y] && this.m_cookieNodesArray[i][cookie_Y].getComponent(\"Cookie\").getCookieType() == cookieType)\n        {\n            i -= 1;\n            horizontalLength += 1;\n        }\n        // Right\n        i = cookie_X + 1\n        while (i < CookieMax_X && this.m_cookieNodesArray[i][cookie_Y] && this.m_cookieNodesArray[i][cookie_Y].getComponent(\"Cookie\").getCookieType() == cookieType)\n        {\n            i += 1;\n            horizontalLength += 1;\n        }\n        if (horizontalLength >= 3)\n        {\n            return true;\n        }\n      \n        // Vertical chain check\n        var verticalLength = 1;\n      \n        // Down\n        i = cookie_Y - 1;\n        while (i >= 0 && this.m_cookieNodesArray[cookie_X][i] && this.m_cookieNodesArray[cookie_X][i].getComponent(\"Cookie\").getCookieType() == cookieType)\n        {\n            i -= 1;\n            verticalLength += 1;\n        }\n        // Up\n        i = cookie_Y + 1;\n        while (i < CookieMax_Y && this.m_cookieNodesArray[cookie_X][i] && this.m_cookieNodesArray[cookie_X][i].getComponent(\"Cookie\").getCookieType() == cookieType)\n        {\n            i += 1;\n            verticalLength += 1;\n        }\n        return verticalLength >= 3;\n    }\n\n    //extra的两个cookie或者normalcookie与extra allcookie交换时调用\n    private detectExtraMatches(firstCookieNode: cc.Node, lastCookieNode: cc.Node): Array<Array<CookieTypeObject>>\n    {\n        let allMatchesArray: Array<Array<CookieTypeObject>> = [];\n        if (firstCookieNode != null && lastCookieNode != null)\n        {\n            let firstScript: Cookie = firstCookieNode.getComponent(\"Cookie\");\n            let lastScript: Cookie = lastCookieNode.getComponent(\"Cookie\");\n            if (firstScript.getExtraType() == CookieExtraType.Extra_Normal && lastScript.getExtraType() == CookieExtraType.Extra_All)\n            {\n                let extraMatchedItem = this.detectExtraAllFuncMatches(lastScript.getCookieObject(), firstScript.getCookieType());\n                extraMatchedItem.push(lastScript.getCookieObject());\n                allMatchesArray.push(extraMatchedItem);\n                lastScript.setExtraTrigerState(true);\n            }\n            else if (firstScript.getExtraType() == CookieExtraType.Extra_All && lastScript.getExtraType() == CookieExtraType.Extra_Normal) {\n                \n                let extraMatchedItem = this.detectExtraAllFuncMatches(firstScript.getCookieObject(), lastScript.getCookieType());\n                extraMatchedItem.push(firstScript.getCookieObject());\n                allMatchesArray.push(extraMatchedItem);\n                firstScript.setExtraTrigerState(true);\n            }\n            else if (firstScript.getExtraType() == CookieExtraType.Extra_All && lastScript.getExtraType() == CookieExtraType.Extra_All)\n            {\n                let extraMatchedItem = this.detectExtraAll_ALL_FuncMatches();\n                if (extraMatchedItem.length > 0)\n                {\n                    allMatchesArray.push(extraMatchedItem);\n                }\n                firstScript.setExtraTrigerState(true);\n                lastScript.setExtraTrigerState(true);\n            }\n            else if (firstScript.getExtraType() == CookieExtraType.Extra_All && lastScript.getExtraType() != CookieExtraType.Extra_Normal) {\n                let extraMatchedItem = this.changeNormalCookieFromExtraAllCookie(lastScript.getCookieObject());\n                extraMatchedItem.push(firstScript.getCookieObject());\n                extraMatchedItem.push(lastScript.getCookieObject());\n                allMatchesArray.push(extraMatchedItem);\n                firstScript.setExtraTrigerState(true);\n            }\n            else if (lastScript.getExtraType() == CookieExtraType.Extra_All && firstScript.getExtraType() != CookieExtraType.Extra_Normal) {\n                let extraMatchedItem = this.changeNormalCookieFromExtraAllCookie(firstScript.getCookieObject());\n                extraMatchedItem.push(firstScript.getCookieObject());\n                extraMatchedItem.push(lastScript.getCookieObject());\n                allMatchesArray.push(extraMatchedItem);\n                lastScript.setExtraTrigerState(true);\n            }\n            else if (firstScript.getExtraType() != CookieExtraType.Extra_Normal && lastScript.getExtraType() != CookieExtraType.Extra_Normal)\n            {\n                if (firstScript.getExtraType() == CookieExtraType.Extra_Bomb)\n                {\n                    if (lastScript.getExtraType() == CookieExtraType.Extra_Bomb)\n                    {\n                        //5*5\n                        let extraMatchedItem = this.detectExtraBombFuncMatches(firstScript.getCookieObject(), 2);\n                        extraMatchedItem.push(firstScript.getCookieObject());\n                        extraMatchedItem.push(lastScript.getCookieObject());\n                        allMatchesArray.push(extraMatchedItem);\n                    }\n                    else if (lastScript.getExtraType() == CookieExtraType.Extra_Line_Horizontal || lastScript.getExtraType() == CookieExtraType.Extra_Line_Vertical)\n                    {\n                        //3行+3列\n                        let extraMatchedItem = this.detectExtraLine_X_Y_FuncMatches(lastScript.getCookieObject(), 1);\n                        extraMatchedItem.push(firstScript.getCookieObject());\n                        extraMatchedItem.push(lastScript.getCookieObject());\n                        allMatchesArray.push(extraMatchedItem);\n                    }\n                }\n                else if (firstScript.getExtraType() == CookieExtraType.Extra_Line_Horizontal || firstScript.getExtraType() == CookieExtraType.Extra_Line_Vertical)\n                {\n                    if (lastScript.getExtraType() == CookieExtraType.Extra_Bomb)\n                    {\n                        //3行+3列\n                        let extraMatchedItem = this.detectExtraLine_X_Y_FuncMatches(firstScript.getCookieObject(), 1);\n                        extraMatchedItem.push(firstScript.getCookieObject());\n                        extraMatchedItem.push(lastScript.getCookieObject());\n                        allMatchesArray.push(extraMatchedItem);\n                    }\n                    else if (lastScript.getExtraType() == CookieExtraType.Extra_Line_Horizontal || lastScript.getExtraType() == CookieExtraType.Extra_Line_Vertical)\n                    {\n                        //1行+1列\n                        let extraMatchedItem = this.detectExtraLine_X_Y_FuncMatches(lastScript.getCookieObject(), 0);\n                        extraMatchedItem.push(firstScript.getCookieObject());\n                        extraMatchedItem.push(lastScript.getCookieObject());\n                        allMatchesArray.push(extraMatchedItem);\n                    }\n                }\n                firstScript.setExtraTrigerState(true);\n                lastScript.setExtraTrigerState(true);\n            }\n        }\n        return allMatchesArray;\n    }\n    //检测普通cookie组成的三消\n    private detectMatches(): Array<Array<CookieTypeObject>>\n    {\n        let allMatchesArray: Array<Array<CookieTypeObject>> = [];\n        let allHorizontalMatchesArray = this.detectHorizontalMatches();\n        let allVerticalMatchesArray = this.detectVerticalMatches();\n        //  combine matches array from horizontal and vertical matches array if possible\n        if (allHorizontalMatchesArray.length == 0)\n        {\n            allMatchesArray = allVerticalMatchesArray;\n        }\n        else if (allVerticalMatchesArray.length == 0)\n        {\n            allMatchesArray = allHorizontalMatchesArray;\n        }\n        else\n        {\n            //  横、竖重叠的要合并成一个array\n            for (let index_H = 0; index_H < allHorizontalMatchesArray.length; index_H++) {\n                const element_H = allHorizontalMatchesArray[index_H];\n                let hasSameCookie: boolean = false;\n                for (let index_V = 0; index_V < allVerticalMatchesArray.length; index_V++) {\n                    const element_V = allVerticalMatchesArray[index_V];\n                    if (ExtraCookieTypeManager.getInstance().hasSameElementTwoArray(element_H, element_V))\n                    {\n                        hasSameCookie = true;\n                        //combine\n                        let combineArray: Array<CookieTypeObject> = [];\n                        for (const key in element_H) {\n                            if (element_H.hasOwnProperty(key)) {\n                                const element = element_H[key];\n                                combineArray.push(element);\n                            }\n                        }\n                        allHorizontalMatchesArray[index_H] = [];\n                        for (const k_V in element_V) {\n                            if (element_V.hasOwnProperty(k_V))\n                            {\n                                const ele = element_V[k_V];\n                                let hasSame = false;\n                                for (let index = 0; index < combineArray.length; index++)\n                                {\n                                    const e = combineArray[index];\n                                    if (ele.pos_X == e.pos_X && ele.pos_Y == e.pos_Y)\n                                    {\n                                        hasSame = true;\n                                        break;\n                                    }\n                                }\n                                if (!hasSame)\n                                {\n                                    combineArray.push(ele);\n                                }\n                            }\n                        }\n                        allVerticalMatchesArray[index_V] = [];\n                        allMatchesArray.push(combineArray);\n                        break;\n                    }\n                }\n                if (!hasSameCookie)\n                {\n                    allMatchesArray.push(element_H);\n                }\n            }\n            for (let index_V = 0; index_V < allVerticalMatchesArray.length; index_V++)\n            {\n                const element_V = allVerticalMatchesArray[index_V];\n                if (element_V.length > 0)\n                {\n                    allMatchesArray.push(element_V);\n                }\n            }\n        }\n        return allMatchesArray;\n    }\n    //  detect extra cookie func chains\n    private detectExtraCookieFuncMatches(extraCookie: CookieTypeObject): Array<CookieTypeObject>\n    {\n        let extraMatchedItem: Array<CookieTypeObject> = [];\n        if (extraCookie.extraType == CookieExtraType.Extra_Line_Horizontal || extraCookie.extraType == CookieExtraType.Extra_Line_Vertical)\n        {\n            extraMatchedItem = this.detectExtraLineFuncMatches(extraCookie);\n        }\n        else if (extraCookie.extraType == CookieExtraType.Extra_Bomb)\n        {\n            extraMatchedItem = this.detectExtraBombFuncMatches(extraCookie, 1);\n        }\n        else if (extraCookie.extraType == CookieExtraType.Extra_All)\n        {\n            let cookieType = Math.floor(Math.random() * CookieType.CookieTypeCount);\n            extraMatchedItem = this.detectExtraAllFuncMatches(extraCookie, cookieType);\n        }\n        return extraMatchedItem;\n    }\n    private detectExtraLineFuncMatches(extraCookie: CookieTypeObject): Array<CookieTypeObject>\n    {\n        let extraMatchedItem: Array<CookieTypeObject> = [];\n        if (extraCookie.extraType == CookieExtraType.Extra_Line_Horizontal)\n        {\n            for (let index = 0; index < CookieMax_X; index++) {\n                let node = this.m_cookieNodesArray[index][extraCookie.pos_Y];\n                if (node != null)\n                {\n                    let script: Cookie = node.getComponent(\"Cookie\");\n                    let cookieObj: CookieTypeObject = {\n                        normalType: script.getCookieType(),\n                        extraType: script.getExtraType(),\n                        pos_X: script.getCookie_X_Y().x,\n                        pos_Y: script.getCookie_X_Y().y,\n                        isOpetation: script.getOperationState(),\n                        isExtraTriger: script.getExtraTrigerState()\n                    }\n                    extraMatchedItem.push(cookieObj);\n                }\n            }\n        }\n        else{\n            for (let index = 0; index < CookieMax_Y; index++) {\n                let node = this.m_cookieNodesArray[extraCookie.pos_X][index];\n                if (node != null)\n                {\n                    let script: Cookie = node.getComponent(\"Cookie\");\n                    let cookieObj: CookieTypeObject = {\n                        normalType: script.getCookieType(),\n                        extraType: script.getExtraType(),\n                        pos_X: script.getCookie_X_Y().x,\n                        pos_Y: script.getCookie_X_Y().y,\n                        isOpetation: script.getOperationState(),\n                        isExtraTriger: script.getExtraTrigerState()\n                    }\n                    extraMatchedItem.push(cookieObj);\n                }\n            }\n        }\n        return extraMatchedItem;\n    }\n    //炸弹消除队列检测，offset=1，默认消除3*3；offset=2，两个bomb的cookie叠加效果消除\n    private detectExtraBombFuncMatches(extraCookie: CookieTypeObject, offset: number): Array<CookieTypeObject>\n    {\n        let extraMatchedItem: Array<CookieTypeObject> = [];\n        if (extraCookie.extraType == CookieExtraType.Extra_Bomb)\n        {\n            for (let index_X = extraCookie.pos_X - offset; index_X <= extraCookie.pos_X + offset; index_X++) {\n                for (let index_Y = extraCookie.pos_Y - offset; index_Y <= extraCookie.pos_Y + offset; index_Y++) {\n                    if (index_X >= 0 && index_X < CookieMax_X && index_Y >= 0 && index_Y < CookieMax_Y)\n                    {\n                        let node = this.m_cookieNodesArray[index_X][index_Y];\n                        if (node != null)\n                        {\n                            let script: Cookie = node.getComponent(\"Cookie\");\n                            let cookieObj: CookieTypeObject = {\n                                normalType: script.getCookieType(),\n                                extraType: script.getExtraType(),\n                                pos_X: script.getCookie_X_Y().x,\n                                pos_Y: script.getCookie_X_Y().y,\n                                isOpetation: script.getOperationState(),\n                                isExtraTriger: script.getExtraTrigerState()\n                            }\n                            extraMatchedItem.push(cookieObj);\n                        }\n                    }\n                }\n            }\n        }\n        return extraMatchedItem;\n    }\n    //bomb的cookie与line的cookie混合消除或者两个line的cookie混合消除，line 的中心点以一个line的cookie为参考\n    private detectExtraLine_X_Y_FuncMatches(lineCookieObj: CookieTypeObject, offset: number): Array<CookieTypeObject>\n    {\n        let extraMatchedItem: Array<CookieTypeObject> = [];\n        // if (extraCookie.extraType == CookieExtraType.Extra_Bomb)\n        // {\n            //添加整列\n            for (let index_X = lineCookieObj.pos_X - offset; index_X <= lineCookieObj.pos_X + offset; index_X++) {\n                for (let index_Y = 0; index_Y < CookieMax_Y; index_Y++) {\n                    if (index_X >= 0 && index_X < CookieMax_X && index_Y >= 0 && index_Y < CookieMax_Y)\n                    {\n                        let node = this.m_cookieNodesArray[index_X][index_Y];\n                        if (node != null)\n                        {\n                            let script: Cookie = node.getComponent(\"Cookie\");\n                            let cookieObj: CookieTypeObject = {\n                                normalType: script.getCookieType(),\n                                extraType: script.getExtraType(),\n                                pos_X: script.getCookie_X_Y().x,\n                                pos_Y: script.getCookie_X_Y().y,\n                                isOpetation: script.getOperationState(),\n                                isExtraTriger: script.getExtraTrigerState()\n                            }\n                            extraMatchedItem.push(cookieObj);\n                        }\n                    }\n                }\n            }\n            //添加整行\n            for (let index_Y = lineCookieObj.pos_Y - offset; index_Y <= lineCookieObj.pos_Y + offset; index_Y++) {\n                for (let index_X = 0; index_X < CookieMax_X; index_X++) {\n                    if (index_X >= 0 && index_X < CookieMax_X && index_Y >= 0 && index_Y < CookieMax_Y)\n                    {\n                        let node = this.m_cookieNodesArray[index_X][index_Y];\n                        if (node != null)\n                        {\n                            let script: Cookie = node.getComponent(\"Cookie\");\n                            let cookieObj: CookieTypeObject = {\n                                normalType: script.getCookieType(),\n                                extraType: script.getExtraType(),\n                                pos_X: script.getCookie_X_Y().x,\n                                pos_Y: script.getCookie_X_Y().y,\n                                isOpetation: script.getOperationState(),\n                                isExtraTriger: script.getExtraTrigerState()\n                            }\n                            let hasAdded: boolean = false;\n                            for (const key in extraMatchedItem) {\n                                if (extraMatchedItem.hasOwnProperty(key)) {\n                                    const element = extraMatchedItem[key];\n                                    if (element.pos_X == cookieObj.pos_X && element.pos_Y == cookieObj.pos_Y)\n                                    {\n                                        hasAdded = true;\n                                        break;\n                                    }\n                                }\n                            }\n                            if (!hasAdded)\n                            {\n                                extraMatchedItem.push(cookieObj);\n                            }\n                        }\n                    }\n                }\n            }\n        // }\n        return extraMatchedItem;\n    }\n    //两个all的cookie组合，全屏消除\n    private detectExtraAll_ALL_FuncMatches(): Array<CookieTypeObject>\n    {\n        let extraMatchedItem: Array<CookieTypeObject> = [];\n        for (let index_X = 0; index_X < CookieMax_X; index_X++) {\n            for (let index_Y = 0; index_Y < CookieMax_Y; index_Y++) {\n                let node = this.m_cookieNodesArray[index_X][index_Y];\n                if (node == null) { continue; }\n                let script = node.getComponent(\"Cookie\");\n                extraMatchedItem.push(script.getCookieObject());\n            }\n        }\n        return extraMatchedItem;\n    }\n    //all的cookie被触发后消除某个类型的cookie\n    private detectExtraAllFuncMatches(extraCookie: CookieTypeObject, targetCookieType: CookieType): Array<CookieTypeObject>\n    {\n        let extraMatchedItem: Array<CookieTypeObject> = [];\n        if (extraCookie.extraType == CookieExtraType.Extra_All && !extraCookie.isExtraTriger)\n        {\n            for (let index_X = 0; index_X < CookieMax_X; index_X++) {\n                for (let index_Y = 0; index_Y < CookieMax_Y; index_Y++) {\n                    let node = this.m_cookieNodesArray[index_X][index_Y];\n                    if (node == null) { continue; }\n                    let script = node.getComponent(\"Cookie\");\n                    if (script.getCookieType() == targetCookieType)\n                    {\n                        extraMatchedItem.push(script.getCookieObject());\n                    }\n                }\n\n            }\n        }\n        return extraMatchedItem;\n    }\n    //all的cookie与extra的其他cookie混合触发后，将其他类型的同normal类型cookie变成类似的extra类型cookie\n    private changeNormalCookieFromExtraAllCookie(extraCookie: CookieTypeObject): Array<CookieTypeObject>\n    {\n        let extraMatchedItem: Array<CookieTypeObject> = [];\n        for (let index_X = 0; index_X < CookieMax_X; index_X++) {\n            for (let index_Y = 0; index_Y < CookieMax_Y; index_Y++) {\n                let node = this.m_cookieNodesArray[index_X][index_Y];\n                if (node == null) { continue; }\n                let script = node.getComponent(\"Cookie\");\n                if (script.getCookieType() == extraCookie.normalType && script.getExtraType() == CookieExtraType.Extra_Normal)\n                {\n                    if (extraCookie.extraType == CookieExtraType.Extra_Bomb)\n                    {\n                        script.setExtraType(CookieExtraType.Extra_Bomb);\n                    }\n                    else if (extraCookie.extraType == CookieExtraType.Extra_Line_Horizontal || extraCookie.extraType == CookieExtraType.Extra_Line_Vertical)\n                    {\n                        script.setExtraType(Math.random() < 0.5 ? CookieExtraType.Extra_Line_Horizontal : CookieExtraType.Extra_Line_Vertical);\n                    }\n                    extraMatchedItem.push(script.getCookieObject());\n                }\n            }\n        }\n        return extraMatchedItem;\n    }\n    //  detect horizontal chains\n    private detectHorizontalMatches(): Array<Array<CookieTypeObject>> {\n        let allHorizontalMatchesArray: Array<Array<CookieTypeObject>> = [];\n        for (let index_Y = 0; index_Y < CookieMax_Y; index_Y++) {\n            let horizontalMatchedItem: Array<CookieTypeObject> = [];\n            let firstCookieNode = null;\n            for (let index_X = 0; index_X < CookieMax_X - 2;) {\n                firstCookieNode = this.m_cookieNodesArray[index_X][index_Y];\n                if (firstCookieNode == null)\n                {\n                    index_X++;\n                    continue; \n                }\n                horizontalMatchedItem = [];\n                let firstScript: Cookie = firstCookieNode.getComponent(\"Cookie\");\n                let firstCookieType = firstScript.getCookieType();\n                let cookieObj: CookieTypeObject = {\n                    normalType: firstCookieType,\n                    extraType: firstScript.getExtraType(),\n                    pos_X: firstScript.getCookie_X_Y().x,\n                    pos_Y: firstScript.getCookie_X_Y().y,\n                    isOpetation: firstScript.getOperationState(),\n                    isExtraTriger: firstScript.getExtraTrigerState()\n                }\n                horizontalMatchedItem.push(cookieObj);\n                let idx = index_X + 1\n                for (; idx < CookieMax_X; idx++)\n                {\n                    let cookieItemNode = this.m_cookieNodesArray[idx][index_Y];\n                    if (cookieItemNode == null) { break; }\n                    let cookieItemScript: Cookie = cookieItemNode.getComponent(\"Cookie\");\n                    if (cookieItemScript.getCookieType() == firstCookieType) {\n                        let cookieObj: CookieTypeObject = {\n                            normalType: firstCookieType,\n                            extraType: cookieItemScript.getExtraType(),\n                            pos_X: cookieItemScript.getCookie_X_Y().x,\n                            pos_Y: cookieItemScript.getCookie_X_Y().y,\n                            isOpetation: cookieItemScript.getOperationState(),\n                            isExtraTriger: cookieItemScript.getExtraTrigerState()\n                        }\n                        horizontalMatchedItem.push(cookieObj);\n                    }\n                    else\n                    {\n                        break;\n                    }\n                }\n                if (horizontalMatchedItem.length >= 3)\n                {\n                    allHorizontalMatchesArray.push(horizontalMatchedItem);\n                    index_X = idx;\n                }\n                else\n                {\n                    index_X++;\n                }\n            }\n        }\n        return allHorizontalMatchesArray;\n    }\n    //  detect vertical chains\n    private detectVerticalMatches(): Array<Array<CookieTypeObject>>\n    {\n        let allVerticalMatchesArray: Array<Array<CookieTypeObject>> = [];\n        for (let index_X = 0; index_X < CookieMax_X; index_X++) {\n            let verticalMatchedItem: Array<CookieTypeObject> = [];\n            let firstCookieNode = null;\n            for (let index_Y = 0; index_Y < CookieMax_Y - 2;) {\n                firstCookieNode = this.m_cookieNodesArray[index_X][index_Y];\n                if (firstCookieNode == null)\n                {\n                    index_Y++;\n                    continue; \n                }\n                verticalMatchedItem = [];\n                let firstScript: Cookie = firstCookieNode.getComponent(\"Cookie\");\n                let firstCookieType = firstScript.getCookieType();\n                let cookieObj: CookieTypeObject = {\n                    normalType: firstCookieType,\n                    extraType: firstScript.getExtraType(),\n                    pos_X: firstScript.getCookie_X_Y().x,\n                    pos_Y: firstScript.getCookie_X_Y().y,\n                    isOpetation: firstScript.getOperationState(),\n                    isExtraTriger: firstScript.getExtraTrigerState()\n                }\n                verticalMatchedItem.push(cookieObj);\n                let idx_y = index_Y + 1\n                for (; idx_y < CookieMax_Y; idx_y++)\n                {\n                    let cookieItemNode = this.m_cookieNodesArray[index_X][idx_y];\n                    if (cookieItemNode == null) { break; }\n                    let cookieItemScript: Cookie = cookieItemNode.getComponent(\"Cookie\");\n                    if (cookieItemScript.getCookieType() == firstCookieType) {\n                        let cookieObj: CookieTypeObject = {\n                            normalType: firstCookieType,\n                            extraType: cookieItemScript.getExtraType(),\n                            pos_X: cookieItemScript.getCookie_X_Y().x,\n                            pos_Y: cookieItemScript.getCookie_X_Y().y,\n                            isOpetation: cookieItemScript.getOperationState(),\n                            isExtraTriger: cookieItemScript.getExtraTrigerState()\n                        }\n                        verticalMatchedItem.push(cookieObj);\n                    }\n                    else\n                    {\n                        break;\n                    }\n                }\n                if (verticalMatchedItem.length >= 3)\n                {\n                    allVerticalMatchesArray.push(verticalMatchedItem);\n                    index_Y = idx_y;\n                }\n                else\n                {\n                    index_Y++;\n                }\n            }\n        }\n        return allVerticalMatchesArray;\n    }\n\n\n\n    private removeMatches(matchesArray: Array<Array<CookieTypeObject>>): number\n    {\n        let delayTime: number = CookieAnimationTimeInterval * 2;\n        this.playMatchAudio();\n        let allExrtaMatchesArray: Array<Array<CookieTypeObject>> = [];\n\n        for (let index = 0; index < matchesArray.length; index++)\n        {\n            const element = matchesArray[index];\n            for (const key in element)\n            {\n                if (element.hasOwnProperty(key))\n                {\n                    const ele = element[key];\n                    if (ele.pos_X >= 0 && ele.pos_X < CookieMax_X && ele.pos_Y >= 0 && ele.pos_Y < CookieMax_Y)\n                    {\n                        let itemNode = this.m_cookieNodesArray[ele.pos_X][ele.pos_Y];\n                        if (itemNode != null)\n                        {\n                            let itemScript: Cookie = itemNode.getComponent(\"Cookie\");\n                            if (itemScript.getExtraType() != CookieExtraType.Extra_Normal && !itemScript.getExtraTrigerState())\n                            {\n                                //特殊道具产生的消除\n                                let extraMatches = this.detectExtraCookieFuncMatches(itemScript.getCookieObject());\n                                if (extraMatches.length > 0)\n                                {\n                                    // this.removeMatches(extraMatches);\n                                    allExrtaMatchesArray.push(extraMatches);\n                                }\n                            }\n                            this.m_cookieNodesArray[ele.pos_X][ele.pos_Y] = null;\n                            itemNode.runAction(cc.sequence(cc.fadeOut(CookieAnimationTimeInterval), cc.delayTime(CookieAnimationTimeInterval), cc.removeSelf()));\n                        }\n                    }\n                }\n            }\n            this.restoreCookieOperateState();\n            if (element.length > 3)\n            {\n                let extraCookieTypeData: CookieTypeObject = ExtraCookieTypeManager.getInstance().getExtraCookieTypeByChain(element);\n                if (extraCookieTypeData != null && this.m_cookieNodesArray[extraCookieTypeData.pos_X][extraCookieTypeData.pos_Y] == null)\n                {\n                    let cookieItem = this.createCookieAtLevel(extraCookieTypeData.pos_X, extraCookieTypeData.pos_Y, extraCookieTypeData.normalType, extraCookieTypeData.extraType, this.getCookiePosition(extraCookieTypeData.pos_X, extraCookieTypeData.pos_Y));\n                    cookieItem.runAction(cc.sequence(cc.scaleTo(CookieAnimationTimeInterval, 1.2), cc.scaleTo(CookieAnimationTimeInterval, 1)));\n                }\n            }\n        }\n        //\n        if (allExrtaMatchesArray.length > 0)\n        {\n            delayTime = CookieAnimationTimeInterval * 3;\n            this.removeMatches(allExrtaMatchesArray);\n        }\n        return delayTime;\n    }\n\n    //  消除之后cookie下落将下面的hole填满\n    private checkFillHolesAnimation() {\n        if (this.checkFillHoles())\n        {\n            //  drop down to fill holes\n            this.node.runAction(cc.sequence(cc.delayTime(CookieAnimationTimeInterval), cc.callFunc(function () \n            {\n                this.checkFillHolesAnimation();\n            }.bind(this))));\n        }\n        else \n        {\n            //  top up to create new cookie\n            this.checkTopUpCookiesAnimation();\n        }\n    }\n    private checkFillHoles(): boolean\n    {\n        let needDropToFill = false;\n        for (let index_X = 0; index_X < CookieMax_X; index_X++)\n        {\n            for (let index_Y = 0; index_Y < CookieMax_Y - 1; index_Y++)\n            {\n                let cookieNode = this.m_cookieNodesArray[index_X][index_Y];\n                if (cookieNode == null && this.m_tilesNodesArray[index_X][index_Y] != null)\n                {\n                    // cookie above shoule drop down here\n                    for (let idx = index_Y + 1; idx < CookieMax_Y; idx++)\n                    {\n                        let itemNode = this.m_cookieNodesArray[index_X][idx];\n                        if (itemNode != null)\n                        {\n                            needDropToFill = true;\n                            break;\n                        }\n                    }\n                }\n                if (needDropToFill)\n                {\n                    break;\n                }\n            }\n            if (needDropToFill)\n            {\n                break;\n            }\n        }\n        if (needDropToFill)\n        {\n            this.fillHoles();\n        }\n        return needDropToFill;\n    }\n    private fillHoles()\n    {\n        this.playFallingAudio();\n        for (let index_X = 0; index_X < CookieMax_X; index_X++)\n        {\n            for (let index_Y = 0; index_Y < CookieMax_Y - 1; index_Y++)\n            {\n                let cookieNode = this.m_cookieNodesArray[index_X][index_Y];\n                if (cookieNode == null && this.m_tilesNodesArray[index_X][index_Y] != null)\n                {\n                    // cookie above shoule drop down here\n                    for (let idx = index_Y + 1; idx < CookieMax_Y; idx++)\n                    {\n                        let itemNode = this.m_cookieNodesArray[index_X][idx];\n                        if (itemNode != null)\n                        {\n                            this.m_cookieNodesArray[index_X][index_Y] = itemNode;\n                            this.m_cookieNodesArray[index_X][idx] = null;\n                            let itemScript: Cookie = itemNode.getComponent(\"Cookie\");\n                            itemScript.setCookie_X_Y(index_X, index_Y);\n                            itemNode.runAction(cc.moveTo(CookieAnimationTimeInterval * Math.abs(idx - index_Y), this.getCookiePosition(index_X, index_Y)));\n                            break;\n                        }                  \n                    }\n                    break;\n                }\n\n            }\n        }\n    }\n\n    //  由上方产生新的cookie并且降落填充\n    private checkTopUpCookiesAnimation() {\n        if (this.checkTopUpCookies())\n        {\n            this.node.runAction(cc.sequence(cc.delayTime(CookieAnimationTimeInterval), cc.callFunc(function () \n            {\n                this.checkTopUpCookiesAnimation();\n            }.bind(this))));\n        }\n        else\n        {\n            this.node.runAction(cc.sequence(cc.delayTime(CookieAnimationTimeInterval), cc.callFunc(function () \n            {\n                this.detectAllChains();\n            }.bind(this))));\n        }\n    }\n    private checkTopUpCookies(): boolean {\n        let needTopUpCookie = false;\n        for (let index_X = 0; index_X < CookieMax_X; index_X++)\n        {\n            for (let index_Y = CookieMax_Y - 1; index_Y >= 0; index_Y--)\n            {\n                let cookieNode = this.m_cookieNodesArray[index_X][index_Y];\n                if (cookieNode == null && this.m_tilesNodesArray[index_X][index_Y] != null)\n                {\n                    needTopUpCookie = true;\n                    break;\n                }\n            }\n            if (needTopUpCookie) { break; }\n        }\n        if (needTopUpCookie)\n        {\n            this.topUpCookies();\n        }\n        return needTopUpCookie;\n    }\n    //  上方产生cookie填充上面数最后一个空白cookie\n    private topUpCookies() {\n        this.playAddCookiesAudio();\n        for (let index_X = 0; index_X < CookieMax_X; index_X++)\n        {\n            //  get top empty tile position\n            let maxY = CookieMax_Y;\n            for (let index_Y = CookieMax_Y - 1; index_Y >= 0; index_Y--)\n            {\n                let tileNode = this.m_tilesNodesArray[index_X][index_Y];\n                if (tileNode != null)\n                {\n                    break;\n                }\n                else\n                {\n                    maxY = index_Y;\n                }\n            }\n            //  get bottom tile position with empty cookie\n            let finalY = CookieMax_Y - 1;\n            for (let tmpY = CookieMax_Y - 1; tmpY >= 0; tmpY--) {\n                if (this.m_tilesNodesArray[index_X][tmpY] != null && this.m_cookieNodesArray[index_X][tmpY] == null)\n                {\n                    finalY = tmpY;\n                }\n            }\n            //  create cookie at top and drop it down\n            if (this.m_tilesNodesArray[index_X][finalY] != null && this.m_cookieNodesArray[index_X][finalY] == null)\n            {\n                let cookieType = Math.floor(Math.random() * CookieType.CookieTypeCount);\n                let cookieItem = this.createCookieAtLevel(index_X, finalY, cookieType, CookieExtraType.Extra_Normal, this.getCookiePosition(index_X, maxY));\n                cookieItem.runAction(cc.moveTo(CookieAnimationTimeInterval * (Math.abs(maxY - finalY)), this.getCookiePosition(index_X, finalY)));    \n            }\n        }\n    }\n\n    private createCookieAtLevel(index_X: number, index_Y: number, cookieType: CookieType, extraCookieType: CookieExtraType = CookieExtraType.Extra_Normal, cookieStartPos?: cc.Vec2): cc.Node\n    {\n        let node = cc.instantiate(this.m_cookieInstance);\n        if (cookieStartPos)\n        {\n            node.setPosition(cookieStartPos);\n        }\n        else\n        {\n            node.setPosition(this.getCookiePosition(index_X, index_Y));\n        }\n        this.m_cookieNode.addChild(node);\n        this.m_cookieNodesArray[index_X][index_Y] = node;\n        let script: Cookie = node.getComponent(\"Cookie\");\n        script.init(index_X, index_Y, cookieType, extraCookieType);\n        script.setCookieMovingSwapDelegate(function (cookieNode: cc.Node, swapDirection: CookieSwapDirection) {\n            this.controlAllCookieTouchable(false);\n            this.startSwapCookies(cookieNode, swapDirection);\n        }.bind(this));\n        return node;\n    }\n    private getCookiePosition(index_X: number, index_Y: number): cc.Vec2\n    {\n        let itemPos: cc.Vec2 = cc.Vec2.ZERO;\n        itemPos.x = CookieTile_Width / 2 + CookieTile_Width * index_X;\n        itemPos.y = CookieTile_Height / 2 + CookieTile_Height * index_Y;\n        return itemPos;\n    }\n\n    private loadAudioRes()\n    {\n        cc.loader.loadRes(\"music/Chomp\", cc.AudioClip, function (err, clip) {\n            this.m_swapAudioClip = clip;\n        }.bind(this));\n        cc.loader.loadRes(\"music/Error\", cc.AudioClip, function (err, clip) {\n            this.m_invalidSwapAudioClip = clip;\n        }.bind(this));\n        cc.loader.loadRes(\"music/KaChing\", cc.AudioClip, function (err, clip) {\n            this.m_matchAudioClip = clip;\n        }.bind(this));\n        cc.loader.loadRes(\"music/Scrape\", cc.AudioClip, function (err, clip) {\n            this.m_fallingAudioClip = clip;\n        }.bind(this));\n        cc.loader.loadRes(\"music/Drip\", cc.AudioClip, function (err, clip) {\n            this.m_addCookiesAudioClip = clip;\n        }.bind(this));\n    }\n    private playSwapAudio()\n    {\n        if (this.m_swapAudioClip == null) { return; }\n        var audioID = cc.audioEngine.playEffect(this.m_swapAudioClip, false);\n    }\n    private playInvalidSwapAudio()\n    {\n        if (this.m_invalidSwapAudioClip == null) { return; }\n        var audioID = cc.audioEngine.playEffect(this.m_invalidSwapAudioClip, false);\n    }\n    private playMatchAudio()\n    {\n        if (this.m_matchAudioClip == null) { return; }\n        var audioID = cc.audioEngine.playEffect(this.m_matchAudioClip, false);\n    }\n    private playFallingAudio()\n    {\n        if (this.m_fallingAudioClip == null) { return; }\n        var audioID = cc.audioEngine.playEffect(this.m_fallingAudioClip, false);\n    }\n    private playAddCookiesAudio()\n    {\n        if (this.m_addCookiesAudioClip == null) { return; }\n        var audioID = cc.audioEngine.playEffect(this.m_addCookiesAudioClip, false);\n    }\n\n\n}\n"]}